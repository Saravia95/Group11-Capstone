# ðŸŽµ JukeVibes - Server

This project is the backend for the JukeVibes, an innovative web-based music system that allows customers to browse, request, and play songs via QR codes. The system is designed to enhance customer experience in venues such as restaurants and cafes by offering a seamless digital jukebox experience.

## Getting Started

### Environment Variables

Before getting started, ensure you have the following environment variables set up:

```env
# Supabase
SUPABASE_URL=your-supabase-url
SUPABASE_SERVICE_ROLE=your-service-role
DATABASE_URL=postgresql://...
DIRECT_URL=postgresql://...

# Spotify
SPOTIFY_CLIENT_ID=your-client-id
SPOTIFY_CLIENT_SECRET=your-client-secret

# Stripe
STRIPE_PUBLIC_KEY=pk_test_...
STRIPE_SECRET_KEY=sk_test_...
```

### Supabase Setup

For guidance on setting up your Supabase project and retrieving the necessary credentials (e.g., `SUPABASE_URL`, `SUPABASE_SERVICE_ROLE`, `DATABASE_URL`, `DIRECT_URL`), please refer to the [Supabase Documentation](https://supabase.com/docs). This resource covers everything from project creation to managing authentication and database settings.

### Spotify API Setup

For detailed instructions on setting up the Spotify API and obtaining your credentials, please refer to the [Spotify Developer Documentation](https://developer.spotify.com/documentation/web-api). Once you have your Client ID and Client Secret, add them to your `.env` file.

### Strip Setup

For detailed instructions on integrating Stripe and obtaining your API keys (i.e., `STRIPE_PUBLIC_KEY` and `STRIPE_SECRET_KEY`), please consult the [Stripe API Documentation](https://docs.stripe.com/). This documentation provides step-by-step guidance for setting up your Stripe account, as well as integration tips for processing payments.

### Install dependencies

Install the required dependencies by running:

```
npm install
```

### Synchronizing the Database Schema

Generate the Prisma client and push your database schema changes:

```
npx prisma generate
npx prisma db push
```

### Deploying Database Migrations with Supabase CLI

Before building and running the project, ensure your latest migration files are pushed to your remote Supabase database. Make sure your environment variables (especially DATABASE_URL or DIRECT_URL) are set correctly in your .env file, then run:

```
supabase link
supabase db push
```

### Building and Running the Project

Build the project and start the server:

```
npm run build
npm run start
```

### Setting Up Google OAuth

For Google OAuth setup, please refer to the Supabase documentation for detailed instructions: [Login with Google](https://supabase.com/docs/guides/auth/social-login/auth-google?queryGroups=platform&platform=web&queryGroups=environment&environment=server&queryGroups=framework&framework=express)

## Folder Structure

```
server/
â”œâ”€â”€ dist/               # Compiled output files generated by TypeScript (after build command)
â”œâ”€â”€ prisma/             # Database schema definitions and migrations managed by Prisma
â”œâ”€â”€ src/                # Main source code of the backend application
â”‚   â”œâ”€â”€ config/         # Configuration files
â”‚   â”œâ”€â”€ controllers/    # Business logic to handle requests and responses (handling routes)
â”‚   â”œâ”€â”€ routes/         # Route definitions that map endpoints to controllers
â”‚   â”œâ”€â”€ services/       # Service layer that contains business logic and database interactions
â”‚   â”œâ”€â”€ types/          # TypeScript type definitions for request, response, and database models
â”‚   â””â”€â”€ index.ts        # Main entry point to initialize and start the Express.js server
â”œâ”€â”€ .prettierrc         # Prettier configuration for code formatting rules
â”œâ”€â”€ tsconfig.json       # TypeScript configuration file to define compiler options
â”œâ”€â”€ package.json        # Project dependencies, scripts, and metadata
â””â”€â”€ README.md
```

## API Features

- **Song Search**: Search songs using Spotify API
  - By title
  - By artist
  - Returns song details including cover image, title, artist, and duration
